---
title: "Homework 9"
author: "Kapil Taspa"
date: "2025-04-20"
output: pdf_document
editor_options: 
  markdown: 
    wrap: sentence
---

UT IED: kt27955

GitHub Link: <https://github.com/ktaspa/Homework9SDS315/>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Problem 1

## A

In the first plot we can see that size is related to number of skips based on the distribution of each size.
In the second plot, we can see that the thickness of the alloy used for soldering is related to the number of skips based on the distribution of thick vs thin.

```{r, echo = FALSE, message = FALSE }
library(ggplot2)
library(dplyr)
library(moderndive)
library(tidyverse)
solder <- read.csv("solder.csv")

ggplot(solder, aes(x = Opening, y = skips)) +
  geom_boxplot() +
  labs(title = "Skips by Opening Size", x = "Opening Size", y = "Number of Skips")

ggplot(solder, aes(x = Solder, y = skips)) +
  geom_boxplot() +
  labs(title = "Skips by Solder Thickness", x = "Solder Thickness", y = "Number of Skips")
```

## B

The estimates and 95% confidence intervals for each coefficient in the model are shown below.

```{r, echo = FALSE}
model <- lm(skips ~ Opening * Solder, data = solder)
summary(model)
confint(model, level = 0.95)
```

## C

1.  The baseline number of skips for a product with Opening L and Solder Thick is approximately 0.39. This is the intercept term.
2.  The main effect of Opening M (compared to Opening L, holding Solder type constant) is an increase of 2.41 skips. This reflects the effect of switching from Opening L to Opening M
3.  The main effect of Opening S is 5.13 skips assuming Solder is held constant.
4.  The main effect of Solder Thin (vs. Solder Thick with Opening L) is 2.28 skips
5.  The interaction term OpeningM:SolderThin is negative 0.74. This means that when both Opening M and Solder Thin are used together, the actual number of skips is 0.74 fewer than what we would expect by just adding their individual effects. Since this value is not statistically significant, we interpret this cautiously.
6.  The interaction term OpeningS:SolderThin is 9.65, which is a large and statistically significant effect. This means that when both Opening S and Solder Thin are used together there are 9.65 more skips than expected from just the sum of the individual effects. There is strong interaction between these factors with 95% certainty

## D

based on this analysis, I would recommend using opening L with thick solder because this would minimize the number of skips in the manufacturing process.
All the other combinations yield a higher number of skips than the baseline in the model so the best choice is opening L and thick solder

# Problem 2

## A

```{r, echo = FALSE}
groceries <- read.csv("groceries.csv")

prices <- groceries %>%
  group_by(Store) %>%
  summarise(avg_price = mean(Price, na.rm = TRUE))

ggplot(prices, aes(x = reorder(Store, avg_price), y = avg_price)) +
  geom_col() +
  coord_flip() +
  labs(title = "Average Price by Store", x = "Store", y = "average price of products sold at that store on",
       caption = "This graph shows the average price at each store. We can see Whole Foods has the highest average price and Fiesta has the lowest from our dataset.")
```

## B

```{r, echo = FALSE}
product_counts <- groceries %>%
  group_by(Product) %>%
  summarise(num_stores = n())

ggplot(product_counts, aes(x = reorder(Product, num_stores), y = num_stores)) +
  geom_col() +
  coord_flip() +
  labs(title = "number of stores selling each product", x = "Product", y = "number of stores selling that product")

```

## C

Compared with ordinary grocery stores (like Albertsons, HEB, or Krogers), convenience stores charge somewhere between 0.41 and 0.92 dollars more for the same product.

```{r, echo = FALSE}
model <- lm(Price ~ Product + Type, data = groceries)
confint(model)

```

## D

Which two stores seem to charge the lowest prices when comparing the same product?
Walmart and Korger Fresh Fare based on the 95% confidence intervals.

Which two stores seem to charge the highest prices when comparing the same product?
Whole Foods and Wheatsville Food Co-Op based on the 95% confidence intervals.

```{r, echo = FALSE}
model <- lm(Price ~ Product + Store, data = groceries)
confint(model)

```

## E

The confidence interval for both Central Market and HEB are both all negative.
Central Market (neg 0.92 to neg 0.23) and HEB (neg 0.95 to neg 0.35).
However, We do not have strong evidence that Central Market charges more than HEB for the same products, because their confidence intervals overlap.
The gap between Central Market and H-E-B is roughly between plus 0.12 and plus 1.17 dollars, depending on where the intervals fall.
The point estimate difference is likely in the 60–70 cent range.

## F

Based on the sign of the Income10K coefficient, do consumers in poorer ZIP codes seem to pay more or less for the same product, on average?
How do you know?
We can't come to a conclusion of if consumers in poorer ZIP codes seem to pay more or less for the same product because the 95% confidence interval contains 0 (neg 0.033, 0.0048).

One-standard deviation increase in the income of a ZIP code seems to be associated with a neg 0.05 standard-deviation change in the price that consumers in that ZIP code expect to pay for the same product

```{r, echo = FALSE, message = FALSE}
groceries <- groceries %>%
  mutate(Income10K = Income / 10000)

model <- lm(Price ~ Product + Income10K, data = groceries)
confint(model)
```

# Problem 3

## A

ZIP codes with a higher percentage of minority residents tend to have more FAIR policies per 100 housing units.

True, the first graph, figure A1, shows a positive linear relationship between percentage of minority and FAIR policies.

## B

The evidence suggests an interaction effect between minority percentage and the age of the housing stock in the way that these two variables are related to the number of FAIR policies in a ZIP code.

False, there is no interaction term between minority percentage and age modeled.
model B shows a 95% confidence interval that includes 0 (neg 0.116, 0.912).
This means there is not evidence of interaction involving age because the outcome is statistically insignificant.

## C

The relationship between minority percentage and number of FAIR policies per 100 housing units is stronger in high-fire-risk ZIP codes than in low-fire-risk ZIP codes.

True, Figure C1 and Model C1 both support this.
In figure C1 we can see the slope for the high fire risk group is greater than the slope for the low fire risk group.

## D

Even without controlling for any other variables, income “explains away” all the association between minority percentage and FAIR policy uptake.

False, income does not explain away the association.
In model D1, the coefficient is 0.014 and in mode D2, which includes income, the coefficient is 0.01.
Both confidence intervals do not contain 0 even after adding income.

## E

Minority percentage and number of FAIR policies are still associated at the ZIP code level, even after controlling for income, fire risk, and housing age.

True, model E has all the control variables and the 95% confidence interval is all positive and does not include 0 (0.003, 0.014).
In addition, r squared is 0.662 meaning the model fits well so there is an association between minority % and FAIR policies.
